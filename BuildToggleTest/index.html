<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Unity Web Player | FullScreenToggle_Project</title>
    <link rel="stylesheet" href="https://storage.googleapis.com/happylearning-tv.appspot.com/games/default/css/style.css">
    <script src="Build/FunctionsFullScreen.js"></script>
</head>
<body>
    <div id="webgl-content" class="webgl-content custom-webgl-content">
        <div id="unityContainer">
            <canvas id="unityCanvas" style="width: 100%; height: 100%;"></canvas>
        </div>
    </div>
    <script>
        function isIOS() {
            var userAgent = window.navigator.userAgent.toLowerCase();
            return /iphone|ipod|ipad/.test(userAgent);
        }

        function adjustFullScreenForIOS() {
            if (isIOS()) {
                var docElement = document.documentElement;
                docElement.style.width = '100%';
                docElement.style.height = '100%';
                docElement.style.overflow = 'hidden';

                var unityContainer = document.getElementById('unityContainer');
                unityContainer.style.width = '100%';
                unityContainer.style.height = '100%';
                unityContainer.style.position = 'absolute';
                unityContainer.style.top = '0';
                unityContainer.style.left = '0';

                window.scrollTo(0, 1);
            }
        }

        // Declarar una variable global para almacenar la instancia de Unity
        var unityInstance;

        var loaderUrl = "Build/BuildToggleTest.loader.js";
        var config = {
            dataUrl: "Build/BuildToggleTest.data.unityweb",
            frameworkUrl: "Build/BuildToggleTest.framework.js.unityweb",
            codeUrl: "Build/BuildToggleTest.wasm.unityweb",
            streamingAssetsUrl: "StreamingAssets",
            companyName: "DefaultCompany",
            productName: "FullScreenToggle_Project",
            productVersion: "1.0",
        };

        var canvas = document.querySelector("#unityCanvas");
        var script = document.createElement("script");
        script.src = loaderUrl;
        script.onload = () => {
            createUnityInstance(canvas, config, (progress) => {}).then((instance) => {
                unityInstance = instance;
                console.log("Unity loaded successfully.");
                adjustFullScreenForIOS();  // Adjust immediately after Unity is loaded
            }).catch((message) => {
                alert(`Failed to load Unity: ${message}`);
            });
        };
        document.body.appendChild(script);

        document.addEventListener('DOMContentLoaded', function() {
            adjustFullScreenForIOS(); // Adjust on initial load
            window.addEventListener("orientationchange", adjustFullScreenForIOS, false);  // Adjust on orientation change
        });
    </script>
</body>
</html>
